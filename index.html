<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="‡¶ú‡¶æ‡¶§‡ßÄ‡¶Ø‡¶º ‡¶Ü‡¶¶‡¶ø‡¶¨‡¶æ‡¶∏‡ßÄ ‡¶™‡¶∞‡¶ø‡¶∑‡¶¶ - ‡¶Ü‡¶¶‡¶ø‡¶¨‡¶æ‡¶∏‡ßÄ‡¶¶‡ßá‡¶∞ ‡¶Ö‡¶ß‡¶ø‡¶ï‡¶æ‡¶∞ ‡¶ì ‡¶â‡¶®‡ßç‡¶®‡¶Ø‡¶º‡¶®‡ßá ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶∂‡ßç‡¶∞‡ßÅ‡¶§‡¶ø‡¶¨‡¶¶‡ßç‡¶ß">
    <title>‡¶ú‡¶æ‡¶§‡ßÄ‡¶Ø‡¶º ‡¶Ü‡¶¶‡¶ø‡¶¨‡¶æ‡¶∏‡ßÄ ‡¶™‡¶∞‡¶ø‡¶∑‡¶¶ - Jatiya Adivasi Parishad</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        * { font-family: 'Hind Siliguri', sans-serif; }
        html { scroll-behavior: smooth; }
        .line-clamp-2 { display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
        .line-clamp-3 { display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .animate-fade-in { animation: fadeIn 0.6s ease-in; }
        
        /* Main loading spinner */
        .loader-container {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
            width: 100%;
        }
        .loader {
            border: 6px solid #f3f3f3;
            border-top: 6px solid #22c55e; /* green-600 */
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
        }
        
        /* Small spinner for buttons */
        .loader-small {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #fff; /* white */
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
            display: inline-block;
            margin-right: 8px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Style for file input */
        input[type="file"]::file-selector-button {
            background-color: #3b82f6; /* blue-500 */
            color: white;
            border: 0;
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        input[type="file"]::file-selector-button:hover {
            background-color: #2563eb; /* blue-600 */
        }

        /* Hide scrollbar for admin panel sidebar */
        .admin-sidebar::-webkit-scrollbar {
            display: none;
        }
        .admin-sidebar {
            -ms-overflow-style: none; /* IE and Edge */
            scrollbar-width: none; /* Firefox */
        }
    </style>
</head>
<body class="bg-gray-50">
    <div id="app">
        <!-- Initial Loading Spinner -->
        <div class="loader-container">
            <div class="loader"></div>
        </div>
    </div>

    <script type="module">
        // --- Firebase Imports ---
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { 
            getAuth, 
            signInWithCustomToken, 
            signInAnonymously, 
            onAuthStateChanged, 
            signOut,
            signInWithEmailAndPassword,
            createUserWithEmailAndPassword
        } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, setDoc, getDoc, onSnapshot, setLogLevel } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        import { getStorage, ref, uploadBytes, getDownloadURL, deleteObject } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-storage.js";

        // --- GLOBAL VARIABLES (from environment) ---
        const firebaseConfig = JSON.parse(typeof __firebase_config !== 'undefined' ? __firebase_config : '{}');
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;

        // --- FIREBASE & APP STATE ---
        let app, auth, db, storage, userId;
        let contentRef; // Firestore document reference
        
        // --- Default Content (used for first-time load) ---
        const defaultContent = {
            siteName: '‡¶ú‡¶æ‡¶§‡ßÄ‡¶Ø‡¶º ‡¶Ü‡¶¶‡¶ø‡¶¨‡¶æ‡¶∏‡ßÄ ‡¶™‡¶∞‡¶ø‡¶∑‡¶¶',
            siteNameEn: 'Jatiya Adivasi Parishad',
            logo: 'https://images.unsplash.com/photo-1582213782179-e0d53f98f2ca?auto=format&fit=crop&w=200&h=80&q=80',
            
            slides: [
                { id: 1, image: 'https://images.unsplash.com/photo-1542601906990-b4d3fb778b09?auto=format&fit=crop&w=1920&q=80', title: '‡¶∏‡¶ï‡¶≤ ‡¶Ü‡¶¶‡¶ø‡¶¨‡¶æ‡¶∏‡ßÄ‡¶∞ ‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶æ, ‡¶Ö‡¶∞‡ßç‡¶•‡¶®‡ßà‡¶§‡¶ø‡¶ï ‡¶ì ‡¶∞‡¶æ‡¶ú‡¶®‡ßà‡¶§‡¶ø‡¶ï ‡¶Æ‡¶æ‡¶® ‡¶â‡¶®‡ßç‡¶®‡¶Ø‡¶º‡¶®', subtitle: '‡¶Ü‡¶¶‡¶ø‡¶¨‡¶æ‡¶∏‡ßÄ‡¶¶‡ßá‡¶∞ ‡¶∏‡ßç‡¶¨‡¶æ‡¶∞‡ßç‡¶• ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶ì ‡¶§‡¶æ‡¶¶‡ßá‡¶∞ ‡¶Ö‡¶ß‡¶ø‡¶ï‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶∑‡ßç‡¶†‡¶æ‡¶Ø‡¶º ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶∂‡ßç‡¶∞‡ßÅ‡¶§‡¶ø‡¶¨‡¶¶‡ßç‡¶ß' },
                { id: 2, image: 'https://images.unsplash.com/photo-1529156069898-49953e39b3ac?auto=format&fit=crop&w=1920&q=80', title: '‡¶Ü‡¶¶‡¶ø‡¶¨‡¶æ‡¶∏‡ßÄ‡¶¶‡ßá‡¶∞ ‡¶≠‡ßÇ‡¶Æ‡¶ø, ‡¶Æ‡¶ú‡ßÅ‡¶∞‡ßÄ ‡¶ì ‡¶ö‡¶æ‡¶ï‡ßÅ‡¶∞‡ßÄ ‡¶∏‡¶Ç‡¶ï‡ßç‡¶∞‡¶æ‡¶®‡ßç‡¶§ ‡¶∏‡ßç‡¶¨‡¶æ‡¶∞‡ßç‡¶• ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£', subtitle: '‡¶∏‡¶ï‡¶≤ ‡¶¨‡¶ø‡¶∞‡ßã‡¶ß ‡¶ì ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ‡¶∞ ‡¶ï‡ßç‡¶∑‡ßá‡¶§‡ßç‡¶∞‡ßá ‡¶Ü‡¶¶‡¶ø‡¶¨‡¶æ‡¶∏‡ßÄ‡¶¶‡ßá‡¶∞ ‡¶∏‡¶æ‡¶π‡¶æ‡¶Ø‡ßç‡¶Ø ‡¶ï‡¶∞‡¶æ' },
            ],
            
            about: { title: '‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶ï‡¶æ‡¶∞‡¶æ', content: '‡¶ú‡¶æ‡¶§‡ßÄ‡¶Ø‡¶º ‡¶Ü‡¶¶‡¶ø‡¶¨‡¶æ‡¶∏‡ßÄ ‡¶™‡¶∞‡¶ø‡¶∑‡¶¶ (‡¶ú‡ßá‡¶è‡¶™‡¶ø) ‡¶è‡¶ï‡¶ü‡¶ø ‡¶Ü‡¶¶‡¶ø‡¶¨‡¶æ‡¶∏‡ßÄ ‡¶∏‡¶Ç‡¶∏‡ßç‡¶•‡¶æ ‡¶Ø‡¶æ ‡¶Ü‡¶¶‡¶ø‡¶¨‡¶æ‡¶∏‡ßÄ-‡¶≠‡¶ø‡¶§‡ßç‡¶§‡¶ø‡¶ï ‡¶∏‡¶Æ‡¶æ‡¶ß‡¶æ‡¶®, ‡¶¨‡¶π‡ßÅ-‡¶ï‡ßç‡¶∑‡ßá‡¶§‡ßç‡¶∞‡ßÄ‡¶Ø‡¶º ‡¶Ö‡¶Ç‡¶∂‡ßÄ‡¶¶‡¶æ‡¶∞‡¶ø‡¶§‡ßç‡¶¨ ‡¶è‡¶¨‡¶Ç ‡¶§‡¶π‡¶¨‡¶ø‡¶≤‡ßá‡¶∞ ‡¶Æ‡¶æ‡¶ß‡ßç‡¶Ø‡¶Æ‡ßá ‡¶Ü‡¶¶‡¶ø‡¶¨‡¶æ‡¶∏‡ßÄ‡¶¶‡ßá‡¶∞ ‡¶∏‡ßç‡¶¨-‡¶â‡¶®‡ßç‡¶®‡¶Ø‡¶º‡¶®, ‡¶∏‡ßç‡¶¨-‡¶∂‡¶æ‡¶∏‡¶® ‡¶è‡¶¨‡¶Ç ‡¶∏‡ßç‡¶¨-‡¶∏‡¶Ç‡¶∏‡ßç‡¶•‡¶æ ‡¶∏‡¶Æ‡¶∞‡ßç‡¶•‡¶® ‡¶ï‡¶∞‡ßá‡•§ ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂‡ßá‡¶∞ ‡¶Ü‡¶¶‡¶ø‡¶¨‡¶æ‡¶∏‡ßÄ ‡¶ú‡¶®‡¶ó‡ßã‡¶∑‡ßç‡¶†‡ßÄ‡¶∞ ‡¶Ö‡¶ß‡¶ø‡¶ï‡¶æ‡¶∞ ‡¶∞‡¶ï‡ßç‡¶∑‡¶æ ‡¶è‡¶¨‡¶Ç ‡¶§‡¶æ‡¶¶‡ßá‡¶∞ ‡¶∏‡¶æ‡¶∞‡ßç‡¶¨‡¶ø‡¶ï ‡¶â‡¶®‡ßç‡¶®‡¶Ø‡¶º‡¶®‡ßá ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶∂‡ßç‡¶∞‡ßÅ‡¶§‡¶ø‡¶¨‡¶¶‡ßç‡¶ß‡•§', image: 'https://images.unsplash.com/photo-1529156069898-49953e39b3ac?auto=format&fit=crop&w=800&q=80' },
            
            mission: { title: '‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶≤‡¶ï‡ßç‡¶∑‡ßç‡¶Ø ‡¶ì ‡¶â‡¶¶‡ßç‡¶¶‡ßá‡¶∂‡ßç‡¶Ø', vision: '‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶è‡¶Æ‡¶® ‡¶è‡¶ï‡¶ü‡¶ø ‡¶≠‡¶¨‡¶ø‡¶∑‡ßç‡¶Ø‡ßé ‡¶ï‡¶≤‡ßç‡¶™‡¶®‡¶æ ‡¶ï‡¶∞‡¶ø ‡¶Ø‡ßá‡¶ñ‡¶æ‡¶®‡ßá ‡¶Ü‡¶¶‡¶ø‡¶¨‡¶æ‡¶∏‡ßÄ‡¶¶‡ßá‡¶∞ ‡¶®‡ßá‡¶§‡ßÉ‡¶§‡ßç‡¶¨‡ßá ‡¶™‡¶∞‡¶ø‡¶ö‡¶æ‡¶≤‡¶ø‡¶§ ‡¶∏‡¶Æ‡¶æ‡¶ß‡¶æ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶ï‡¶∞‡ßç‡¶Æ‡¶ï‡¶æ‡¶£‡ßç‡¶° ‡¶∏‡¶ï‡¶≤‡ßá‡¶∞ ‡¶è‡¶¨‡¶Ç ‡¶™‡ßÉ‡¶•‡¶ø‡¶¨‡ßÄ ‡¶Æ‡¶æ‡¶§‡¶æ‡¶∞ ‡¶≠‡¶¨‡¶ø‡¶∑‡ßç‡¶Ø‡¶§‡¶ï‡ßá ‡¶∏‡ßÅ‡¶∞‡¶ï‡ßç‡¶∑‡¶ø‡¶§ ‡¶ï‡¶∞‡¶¨‡ßá‡•§', mission: '‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶Ü‡¶¶‡¶ø‡¶¨‡¶æ‡¶∏‡ßÄ‡¶¶‡ßá‡¶∞ ‡¶Æ‡¶æ‡¶§‡ßÉ‡¶≠‡ßÇ‡¶Æ‡¶ø‡¶∞ ‡¶∏‡ßÅ‡¶∞‡¶ï‡ßç‡¶∑‡¶æ‡¶Ø‡¶º ‡¶§‡¶æ‡¶¶‡ßá‡¶∞ ‡¶Ö‡¶¨‡¶¶‡¶æ‡¶®‡¶ï‡ßá ‡¶â‡¶®‡ßç‡¶®‡ßÄ‡¶§ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡¶ø ‡¶è‡¶¨‡¶Ç ‡¶¨‡¶ø‡¶∂‡ßç‡¶¨‡¶¨‡ßç‡¶Ø‡¶æ‡¶™‡ßÄ ‡¶ö‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶û‡ßç‡¶ú‡ßá‡¶∞ ‡¶¨‡¶ø‡¶∞‡ßÅ‡¶¶‡ßç‡¶ß‡ßá ‡¶≤‡¶°‡¶º‡¶æ‡¶á ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶∏‡¶Æ‡¶æ‡¶ß‡¶æ‡¶® ‡¶™‡ßç‡¶∞‡¶¶‡¶æ‡¶®‡¶ï‡¶æ‡¶∞‡ßÄ ‡¶è‡¶¨‡¶Ç ‡¶Ö‡¶Ç‡¶∂‡ßÄ‡¶¶‡¶æ‡¶∞ ‡¶π‡¶ø‡¶∏‡ßá‡¶¨‡ßá ‡¶§‡¶æ‡¶¶‡ßá‡¶∞ ‡¶∏‡ßç‡¶¨‡ßÄ‡¶ï‡ßÉ‡¶§‡¶ø ‡¶¶‡¶ø‡¶á‡•§' },
            
            objectives: [
                { id: 1, icon: 'üåç', title: '‡¶Ü‡¶¶‡¶ø‡¶¨‡¶æ‡¶∏‡ßÄ ‡¶∏‡¶æ‡¶Ç‡¶∏‡ßç‡¶ï‡ßÉ‡¶§‡¶ø‡¶ï ‡¶≠‡ßÇ‡¶¶‡ßÉ‡¶∂‡ßç‡¶Ø', description: '‡¶Ü‡¶¶‡¶ø‡¶¨‡¶æ‡¶∏‡ßÄ ‡¶Ö‡¶û‡ßç‡¶ö‡¶≤ ‡¶è‡¶¨‡¶Ç ‡¶∏‡¶Æ‡ßç‡¶™‡ßç‡¶∞‡¶¶‡¶æ‡¶Ø‡¶º‡ßá‡¶∞ ‡¶Ü‡¶¶‡¶ø‡¶¨‡¶æ‡¶∏‡ßÄ ‡¶∂‡¶æ‡¶∏‡¶®, ‡¶∏‡ßç‡¶¨-‡¶â‡¶®‡ßç‡¶®‡¶Ø‡¶º‡¶® ‡¶è‡¶¨‡¶Ç ‡¶Ü‡¶∞‡ßç‡¶•‡¶ø‡¶ï ‡¶∏‡ßç‡¶•‡¶æ‡¶Ø‡¶º‡¶ø‡¶§‡ßç‡¶¨‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ö‡¶®‡ßÅ‡¶ò‡¶ü‡¶ï ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶æ‡•§' },
                { id: 2, icon: 'üí∞', title: '‡¶Ü‡¶¶‡¶ø‡¶¨‡¶æ‡¶∏‡ßÄ ‡¶Ö‡¶®‡ßÅ‡¶¶‡¶æ‡¶® ‡¶ì ‡¶§‡¶π‡¶¨‡¶ø‡¶≤', description: '‡¶Ü‡¶¶‡¶ø‡¶¨‡¶æ‡¶∏‡ßÄ‡¶¶‡ßá‡¶∞ ‡¶®‡ßá‡¶§‡ßÉ‡¶§‡ßç‡¶¨‡ßá ‡¶§‡¶π‡¶¨‡¶ø‡¶≤ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶∏‡ßç‡¶•‡¶æ‡¶™‡¶®‡¶æ‡¶ï‡ßá ‡¶â‡ßé‡¶∏‡¶æ‡¶π‡¶ø‡¶§ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ö‡¶®‡ßÅ‡¶¶‡¶æ‡¶® ‡¶™‡ßç‡¶∞‡¶¶‡¶æ‡¶®‡ßá‡¶∞ ‡¶Ø‡¶®‡ßç‡¶§‡ßç‡¶∞ ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶æ‡•§' },
            ],
            
            newsAndEvents: [
                { id: 1, type: 'news', title: '‡¶Ü‡¶¶‡¶ø‡¶¨‡¶æ‡¶∏‡ßÄ ‡¶Ö‡¶ß‡¶ø‡¶ï‡¶æ‡¶∞ ‡¶∏‡¶Æ‡ßç‡¶Æ‡ßá‡¶≤‡¶® ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶®', excerpt: '‡¶ú‡¶æ‡¶§‡ßÄ‡¶Ø‡¶º ‡¶Ü‡¶¶‡¶ø‡¶¨‡¶æ‡¶∏‡ßÄ ‡¶™‡¶∞‡¶ø‡¶∑‡¶¶‡ßá‡¶∞ ‡¶â‡¶¶‡ßç‡¶Ø‡ßã‡¶ó‡ßá ‡¶Ü‡¶Ø‡¶º‡ßã‡¶ú‡¶ø‡¶§ ‡¶¨‡¶æ‡¶∞‡ßç‡¶∑‡¶ø‡¶ï ‡¶∏‡¶Æ‡ßç‡¶Æ‡ßá‡¶≤‡¶®‡ßá ‡¶¶‡ßá‡¶∂‡¶¨‡ßç‡¶Ø‡¶æ‡¶™‡ßÄ ‡¶Ü‡¶¶‡¶ø‡¶¨‡¶æ‡¶∏‡ßÄ ‡¶®‡ßá‡¶§‡¶æ‡¶∞‡¶æ ‡¶Ö‡¶Ç‡¶∂‡¶ó‡ßç‡¶∞‡¶π‡¶£ ‡¶ï‡¶∞‡ßá‡¶®‡•§', date: '‡ßß‡ß´ ‡¶°‡¶ø‡¶∏‡ßá‡¶Æ‡ßç‡¶¨‡¶∞ ‡ß®‡ß¶‡ß®‡ß™', image: 'https://images.unsplash.com/photo-1540575467063-178a50c2df87?auto=format&fit=crop&w=800&q=80', author: '‡¶ú‡¶æ‡¶§‡ßÄ‡¶Ø‡¶º ‡¶Ü‡¶¶‡¶ø‡¶¨‡¶æ‡¶∏‡ßÄ ‡¶™‡¶∞‡¶ø‡¶∑‡¶¶', category: '‡¶∏‡¶Æ‡ßç‡¶Æ‡ßá‡¶≤‡¶®', content: '‡¶ó‡¶§ ‡ßß‡ß´ ‡¶°‡¶ø‡¶∏‡ßá‡¶Æ‡ßç‡¶¨‡¶∞ ‡ß®‡ß¶‡ß®‡ß™ ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ‡ßá ‡¶∞‡¶æ‡¶ú‡¶∂‡¶æ‡¶π‡ßÄ‡¶§‡ßá ‡¶ú‡¶æ‡¶§‡ßÄ‡¶Ø‡¶º ‡¶Ü‡¶¶‡¶ø‡¶¨‡¶æ‡¶∏‡ßÄ ‡¶™‡¶∞‡¶ø‡¶∑‡¶¶‡ßá‡¶∞ ‡¶â‡¶¶‡ßç‡¶Ø‡ßã‡¶ó‡ßá "‡¶Ü‡¶¶‡¶ø‡¶¨‡¶æ‡¶∏‡ßÄ ‡¶Ö‡¶ß‡¶ø‡¶ï‡¶æ‡¶∞ ‡¶ì ‡¶â‡¶®‡ßç‡¶®‡¶Ø‡¶º‡¶® ‡¶∏‡¶Æ‡ßç‡¶Æ‡ßá‡¶≤‡¶® ‡ß®‡ß¶‡ß®‡ß™" ‡¶∂‡ßÄ‡¶∞‡ßç‡¶∑‡¶ï ‡¶è‡¶ï‡¶ü‡¶ø ‡¶ó‡ßÅ‡¶∞‡ßÅ‡¶§‡ßç‡¶¨‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶∏‡¶Æ‡ßç‡¶Æ‡ßá‡¶≤‡¶® ‡¶Ö‡¶®‡ßÅ‡¶∑‡ßç‡¶†‡¶ø‡¶§ ‡¶π‡¶Ø‡¶º‡•§' },
            ],
            
            gallery: [
                { id: 1, image: 'https://images.unsplash.com/photo-1542601906990-b4d3fb778b09?auto=format&fit=crop&w=800&q=80', title: '‡¶∏‡¶Æ‡ßç‡¶™‡ßç‡¶∞‡¶¶‡¶æ‡¶Ø‡¶º ‡¶∏‡¶Æ‡¶æ‡¶¨‡ßá‡¶∂', description: '‡¶Ü‡¶¶‡¶ø‡¶¨‡¶æ‡¶∏‡ßÄ ‡¶∏‡¶Æ‡ßç‡¶™‡ßç‡¶∞‡¶¶‡¶æ‡¶Ø‡¶º‡ßá‡¶∞ ‡¶∏‡¶¶‡¶∏‡ßç‡¶Ø‡¶∞‡¶æ ‡¶è‡¶ï‡¶§‡ßç‡¶∞‡¶ø‡¶§' },
            ],
            
            contact: {
                address: '‡¶ï‡ßá‡¶®‡ßç‡¶¶‡ßç‡¶∞‡ßÄ‡¶Ø‡¶º ‡¶ï‡¶Æ‡¶ø‡¶ü‡¶ø: ‡¶ó‡¶£‡¶ï‡¶™‡¶æ‡¶°‡¶º‡¶æ, ‡¶∞‡¶æ‡¶ú‡¶∂‡¶æ‡¶π‡ßÄ -‡ß¨‡ßß‡ß¶‡ß¶',
                phone: '+88 01719-022761',
                phone2: '+88 01718-874506',
                email: 'jap3s1993@gmail.com',
                facebook: 'https://facebook.com/jatiyaadivasiparishad',
                twitter: 'https://twitter.com/japarishad',
                instagram: 'https://instagram.com/japarishad'
            }
        };

        // --- Local UI State ---
        const state = {
            // App State
            view: 'public', // 'public' or 'admin'
            isAdmin: false,
            isLoading: true,
            
            // Public View State
            isMenuOpen: false,
            currentSlide: 0,
            selectedImage: null,
            selectedNews: null,
            newsFilter: 'all',
            searchQuery: '',
            
            // Admin View State
            adminSection: 'dashboard', // 'dashboard', 'slides', 'about', 'gallery', etc.
            isUploading: false,
            adminForm: {
                // Holds data for add/edit forms
            },
            adminEditId: null, // Holds ID of item being edited
            
            // Login Modal State
            showLogin: false,
            loginTab: 'login', // 'login' or 'signup'
            loginEmail: '',
            loginPassword: '',
            loginError: '',

            siteData: null // Start with null, will be loaded
        };

        // --- Firebase Functions ---

        function initializeFirebase() {
            try {
                app = initializeApp(firebaseConfig);
                auth = getAuth(app);
                db = getFirestore(app);
                storage = getStorage(app); // Initialize Firebase Storage
                setLogLevel('Debug');
                console.log("Firebase initialized.");
                handleAuthentication();
            } catch (error) {
                console.error("Firebase initialization failed:", error);
                state.siteData = defaultContent;
                state.isLoading = false;
                render();
            }
        }

        async function handleAuthentication() {
            // Set up the listener for auth changes (login, logout) FIRST
            onAuthStateChanged(auth, async (user) => {
                if (user && !user.isAnonymous) {
                    userId = user.uid;
                    state.isAdmin = true;
                    console.log("Admin user is logged in:", userId);
                } else {
                    // This will be true for anonymous users or logged-out users
                    userId = user ? user.uid : null; // Anonymous user ID or null
                    state.isAdmin = false;
                    if (state.view === 'admin') { // Boot 'em out
                        state.view = 'public'; 
                    }
                    console.log(user ? "User is anonymous." : "User is logged out.");
                }
                
                // Set up Firestore ref. This path is public.
                contentRef = doc(db, 'artifacts', appId, 'public/data/jap-content', 'main');

                // --- THIS IS THE KEY ---
                // Only attempt to read/write Firestore if we have *some* auth
                if (user) { 
                    await checkAndInitializeContent();
                    
                    if (!state.siteData) { // Only attach listener once
                        listenToContentChanges();
                    } else {
                        render(); // Already have data, just re-render UI
                    }
                } else {
                    // No user at all (shouldn't happen with anonymous sign-in, but as a fallback)
                    console.log("No user, holding off on Firestore init. Attempting anonymous sign-in.");
                    // We *still* need to sign in anonymously if there's no user.
                    try {
                        await signInAnonymously(auth);
                        console.log("Signed in anonymously.");
                        // The listener will re-fire with the new anonymous user
                    } catch (anonError) {
                        console.error("Anonymous sign-in failed:", anonError);
                        // Show error or default content without Firestore
                        state.siteData = defaultContent;
                        state.isLoading = false;
                        render();
                    }
                }
            });

            // --- Trigger the auth flow ---
            // The listener is set up, now check the initial state.
            if (initialAuthToken) {
                try {
                    // Check if user is already signed in with this token
                    if (auth.currentUser?.uid !== initialAuthToken.substring(0, 28)) { // Simple check
                        await signInWithCustomToken(auth, initialAuthToken);
                    }
                } catch (e) {
                    console.warn("Custom token sign-in failed, falling back to anonymous.", e);
                    if (!auth.currentUser) { // Only sign in if no user
                        await signInAnonymously(auth);
                    }
                }
            } else if (!auth.currentUser) {
                // If no token and no user, sign in anonymously for public view
                // The onAuthStateChanged listener will catch this.
                await signInAnonymously(auth);
            }
            // If auth.currentUser *already* exists, the listener will have fired with it already.
        }
        
        async function handleLogin() {
            state.loginError = '';
            if (!state.loginEmail || !state.loginPassword) {
                state.loginError = '‡¶á‡¶Æ‡ßá‡¶≤ ‡¶è‡¶¨‡¶Ç ‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®‡•§';
                render();
                return;
            }
            try {
                await signInWithEmailAndPassword(auth, state.loginEmail, state.loginPassword);
                // Success is handled by onAuthStateChanged
                state.showLogin = false;
                state.view = 'admin'; // Go to admin panel on login
                clearLoginFields();
            } catch (error) {
                console.error("Login failed:", error);
                state.loginError = '‡¶≤‡¶ó‡¶á‡¶® ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶• ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§ ‡¶á‡¶Æ‡ßá‡¶≤ ‡¶¨‡¶æ ‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶≠‡ßÅ‡¶≤‡•§';
                render();
            }
        }

        async function handleSignUp() {
            state.loginError = '';
            if (!state.loginEmail || !state.loginPassword) {
                state.loginError = '‡¶á‡¶Æ‡ßá‡¶≤ ‡¶è‡¶¨‡¶Ç ‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®‡•§';
                render();
                return;
            }
            try {
                await createUserWithEmailAndPassword(auth, state.loginEmail, state.loginPassword);
                // Success is handled by onAuthStateChanged
                state.showLogin = false;
                state.view = 'admin'; // Go to admin panel on sign up
                clearLoginFields();
            } catch (error) {
                console.error("Sign up failed:", error);
                state.loginError = '‡¶∏‡¶æ‡¶á‡¶® ‡¶Ü‡¶™ ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶• ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§ ‡¶á‡¶Æ‡ßá‡¶≤‡¶ü‡¶ø ‡¶ï‡¶ø ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡ßÉ‡¶§?';
                render();
            }
        }

        async function handleLogout() {
            await signOut(auth);
            // Success is handled by onAuthStateChanged, which will set isAdmin to false
            // and view to 'public'
            
            // Sign back in anonymously for public view
            await signInAnonymously(auth);
        }

        function clearLoginFields() {
            state.loginEmail = '';
            state.loginPassword = '';
            state.loginError = '';
        }

        async function checkAndInitializeContent() {
            if (!contentRef) return;
            try {
                const docSnap = await getDoc(contentRef);
                if (!docSnap.exists()) {
                    console.log("No content found. Initializing with default content.");
                    // Use default content and save it (only if admin)
                    state.siteData = defaultContent;
                    if(state.isAdmin) {
                        await setDoc(contentRef, defaultContent);
                    }
                } else {
                    console.log("Content document found.");
                    state.siteData = docSnap.data();
                }
            } catch (error) {
                console.error("Error checking/initializing content:", error);
                state.siteData = defaultContent;
            }
            state.isLoading = false;
        }

        function listenToContentChanges() {
            if (!contentRef) return;
            
            onSnapshot(contentRef, (docSnap) => {
                if (docSnap.exists()) {
                    console.log("Content updated from Firestore.");
                    state.siteData = docSnap.data();
                } else {
                    console.log("Content document missing. Using default.");
                    state.siteData = defaultContent;
                }
                state.isLoading = false;
                render(); // Re-render the app with new data
            }, (error) => {
                console.error("Error listening to content:", error);
                state.siteData = defaultContent; // Fallback to default
                state.isLoading = false;
                render();
            });
        }

        // --- Data Save/Upload Functions ---

        // This is the new MASTER save function.
        // It saves the entire siteData object.
        async function saveFullSiteData(dataToSave = state.siteData) {
            if (!state.isAdmin) {
                console.warn("Permission denied. Not an admin.");
                return;
            }
            console.log("Saving full site data to Firebase...");
            try {
                await setDoc(contentRef, dataToSave);
                console.log("Site data saved successfully.");
                return true;
            } catch (e) { 
                console.error("Save failed:", e); 
                alert("‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶• ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§ ‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§");
                return false;
            }
        }

        // --- File Upload Helper ---
        async function uploadFile(file, path) {
            if (!file) return null;
            
            const storageRef = ref(storage, `${path}/${Date.now()}_${file.name}`);
            const snapshot = await uploadBytes(storageRef, file);
            const downloadURL = await getDownloadURL(snapshot.ref);
            return downloadURL;
        }

        // --- UI Functions ---
        
        function scrollToSection(id) {
            document.getElementById(id)?.scrollIntoView({ behavior: 'smooth' });
            state.isMenuOpen = false;
            render();
        }

        function getFilteredNews() {
            if (!state.siteData || !state.siteData.newsAndEvents) return [];
            return state.siteData.newsAndEvents.filter(item => {
                const matchesFilter = state.newsFilter === 'all' || item.type === state.newsFilter;
                const matchesSearch = state.searchQuery === '' || 
                    item.title.toLowerCase().includes(state.searchQuery.toLowerCase()) ||
                    item.excerpt.toLowerCase().includes(state.searchQuery.toLowerCase());
                return matchesFilter && matchesSearch;
            });
        }

        // Make functions global so inline handlers can find them
        window.scrollToSection = scrollToSection;
        window.handleLogout = handleLogout;
        window.handleLogin = handleLogin;
        window.handleSignUp = handleSignUp;
        window.state = state; // Expose state for inline handlers
        window.clearLoginFields = clearLoginFields; // <-- Fix ReferenceError

        // --- Main Render Function ---
        function render() {
            const app = document.getElementById('app');
            
            if (state.isLoading || !state.siteData) {
                app.innerHTML = `<div class="loader-container"><div class="loader"></div></div>`;
                return;
            }

            if (state.view === 'public') {
                app.innerHTML = renderPublicWebsite();
            } else if (state.view === 'admin') {
                app.innerHTML = renderAdminDashboard();
            }

            // Add login modal on top if needed
            if (state.showLogin) {
                app.innerHTML += renderLoginModal();
            }
            
            // Re-attach scroll listener after render
            const scrollTopBtn = document.getElementById('scrollTopBtn');
            window.onscroll = () => {
                if (scrollTopBtn) {
                    scrollTopBtn.style.display = window.scrollY > 300 ? 'flex' : 'none';
                }
            };
        }
        window.render = render; // Expose render globally

        // --- ADMIN: Render Admin Dashboard ---
        function renderAdminDashboard() {
            return `
                <div class="flex h-screen bg-gray-100">
                    <!-- Sidebar -->
                    <div class="w-64 bg-gray-800 text-white flex flex-col admin-sidebar overflow-y-auto">
                        <div class="px-6 py-4 bg-gray-900">
                            <h2 class="text-2xl font-bold">‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤</h2>
                            <p class="text-sm text-gray-400">${state.siteData.siteName}</p>
                        </div>
                        <nav class="flex-1 px-4 py-6 space-y-2">
                            ${[
                                { id: 'dashboard', name: '‡¶°‡ßç‡¶Ø‡¶æ‡¶∂‡¶¨‡ßã‡¶∞‡ßç‡¶°', icon: 'fa-home' },
                                { id: 'general', name: '‡¶∏‡¶æ‡¶ß‡¶æ‡¶∞‡¶£ ‡¶§‡¶•‡ßç‡¶Ø', icon: 'fa-cog' },
                                { id: 'slides', name: '‡¶π‡¶ø‡¶∞‡ßã ‡¶∏‡ßç‡¶≤‡¶æ‡¶á‡¶°', icon: 'fa-images' },
                                { id: 'about', name: '‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶ï‡¶æ‡¶∞‡¶æ', icon: 'fa-info-circle' },
                                { id: 'mission', name: '‡¶≤‡¶ï‡ßç‡¶∑‡ßç‡¶Ø ‡¶ì ‡¶â‡¶¶‡ßç‡¶¶‡ßá‡¶∂‡ßç‡¶Ø', icon: 'fa-bullseye' },
                                { id: 'objectives', name: '‡¶â‡¶¶‡ßç‡¶¶‡ßá‡¶∂‡ßç‡¶Ø', icon: 'fa-tasks' },
                                { id: 'news', name: '‡¶∏‡¶Ç‡¶¨‡¶æ‡¶¶ ‡¶ì ‡¶á‡¶≠‡ßá‡¶®‡ßç‡¶ü', icon: 'fa-newspaper' },
                                { id: 'gallery', name: '‡¶´‡¶ü‡ßã ‡¶ó‡ßç‡¶Ø‡¶æ‡¶≤‡¶æ‡¶∞‡¶ø', icon: 'fa-camera-retro' },
                                { id: 'contact', name: '‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó', icon: 'fa-phone' },
                            ].map(item => `
                                <button onclick="state.adminSection = '${item.id}'; render();" 
                                    class="w-full flex items-center px-4 py-3 rounded-lg transition ${state.adminSection === item.id ? 'bg-green-600' : 'hover:bg-gray-700'}">
                                    <i class="fas ${item.icon} w-6 text-center"></i>
                                    <span class="ml-3">${item.name}</span>
                                </button>
                            `).join('')}
                        </nav>
                        <div class="px-4 py-4 border-t border-gray-700 space-y-2">
                            <button onclick="state.view = 'public'; render();" class="w-full flex items-center px-4 py-3 rounded-lg transition hover:bg-gray-700">
                                <i class="fas fa-eye w-6 text-center"></i>
                                <span class="ml-3">‡¶ì‡¶Ø‡¶º‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®</span>
                            </button>
                            <button onclick="handleLogout()" class="w-full flex items-center px-4 py-3 rounded-lg transition text-red-400 hover:bg-red-600 hover:text-white">
                                <i class="fas fa-sign-out-alt w-6 text-center"></i>
                                <span class="ml-3">‡¶≤‡¶ó ‡¶Ü‡¶â‡¶ü</span>
                            </button>
                        </div>
                    </div>

                    <!-- Main Content -->
                    <div class="flex-1 flex flex-col overflow-y-auto">
                        <header class="bg-white shadow-md p-6">
                            <h1 class="text-3xl font-bold text-gray-800 capitalize">${state.adminSection.replace('-', ' ')}</h1>
                        </header>
                        <main class="p-6 space-y-6">
                            ${renderAdminSectionContent()}
                        </main>
                    </div>
                </div>
            `;
        }
        
        // --- ADMIN: Render Section-Specific Content ---
        function renderAdminSectionContent() {
            switch(state.adminSection) {
                case 'dashboard':
                    return `
                        <div class="bg-white p-6 rounded-xl shadow-lg">
                            <h2 class="text-2xl font-semibold mb-4">‡¶∏‡ßç‡¶¨‡¶æ‡¶ó‡¶§‡¶Æ, ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶®!</h2>
                            <p class="text-gray-700">‡¶¨‡¶æ‡¶Æ ‡¶¶‡¶ø‡¶ï‡ßá‡¶∞ ‡¶Æ‡ßá‡¶®‡ßÅ ‡¶•‡ßá‡¶ï‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ì‡¶Ø‡¶º‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü‡ßá‡¶∞ ‡¶¨‡¶ø‡¶≠‡¶ø‡¶®‡ßç‡¶® ‡¶Ö‡¶Ç‡¶∂ ‡¶∏‡¶Æ‡ßç‡¶™‡¶æ‡¶¶‡¶®‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</p>
                        </div>
                    `;
                case 'general':
                    return renderAdminForm({
                        title: '‡¶∏‡¶æ‡¶ß‡¶æ‡¶∞‡¶£ ‡¶§‡¶•‡ßç‡¶Ø',
                        fields: [
                            { id: 'siteName', label: '‡¶∏‡¶æ‡¶á‡¶ü‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ (‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ)', value: state.siteData.siteName, type: 'text' },
                            { id: 'siteNameEn', label: '‡¶∏‡¶æ‡¶á‡¶ü‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ (English)', value: state.siteData.siteNameEn, type: 'text' },
                            { id: 'logo', label: '‡¶≤‡ßã‡¶ó‡ßã URL', value: state.siteData.logo, type: 'text' },
                            // TODO: Add logo file upload
                        ],
                        onSave: async (formData) => {
                            state.siteData.siteName = formData.siteName;
                            state.siteData.siteNameEn = formData.siteNameEn;
                            state.siteData.logo = formData.logo;
                            await saveFullSiteData();
                            alert("‡¶∏‡¶æ‡¶ß‡¶æ‡¶∞‡¶£ ‡¶§‡¶•‡ßç‡¶Ø ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶ø‡¶§ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!");
                        }
                    });
                case 'about':
                    return renderAdminForm({
                        title: '‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶ï‡¶æ‡¶∞‡¶æ',
                        fields: [
                            { id: 'title', label: '‡¶∂‡¶ø‡¶∞‡ßã‡¶®‡¶æ‡¶Æ', value: state.siteData.about.title, type: 'text' },
                            { id: 'content', label: '‡¶¨‡¶ø‡¶¨‡¶∞‡¶£', value: state.siteData.about.content, type: 'textarea' },
                            { id: 'imageFile', label: '‡¶®‡¶§‡ßÅ‡¶® ‡¶õ‡¶¨‡¶ø ‡¶Ü‡¶™‡¶≤‡ßã‡¶°', type: 'file', accept: 'image/*' },
                            { id: 'image', label: '‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶õ‡¶¨‡¶ø‡¶∞ URL', value: state.siteData.about.image, type: 'text', disabled: true },
                        ],
                        onSave: async (formData, files) => {
                            state.isUploading = true; render();
                            const newImageUrl = await uploadFile(files.imageFile, 'about');
                            
                            state.siteData.about.title = formData.title;
                            state.siteData.about.content = formData.content;
                            if (newImageUrl) {
                                state.siteData.about.image = newImageUrl;
                            }
                            await saveFullSiteData();
                            state.isUploading = false;
                            alert("‡¶§‡¶•‡ßç‡¶Ø ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶ø‡¶§ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!");
                            render();
                        }
                    });
                case 'mission':
                     return renderAdminForm({
                        title: '‡¶≤‡¶ï‡ßç‡¶∑‡ßç‡¶Ø ‡¶ì ‡¶â‡¶¶‡ßç‡¶¶‡ßá‡¶∂‡ßç‡¶Ø',
                        fields: [
                            { id: 'title', label: '‡¶∂‡¶ø‡¶∞‡ßã‡¶®‡¶æ‡¶Æ', value: state.siteData.mission.title, type: 'text' },
                            { id: 'vision', label: '‡¶¶‡ßÉ‡¶∑‡ßç‡¶ü‡¶ø‡¶≠‡¶ô‡ßç‡¶ó‡¶ø', value: state.siteData.mission.vision, type: 'textarea' },
                            { id: 'mission', label: '‡¶Æ‡¶ø‡¶∂‡¶®', value: state.siteData.mission.mission, type: 'textarea' },
                        ],
                        onSave: async (formData) => {
                            state.siteData.mission.title = formData.title;
                            state.siteData.mission.vision = formData.vision;
                            state.siteData.mission.mission = formData.mission;
                            await saveFullSiteData();
                            alert("‡¶§‡¶•‡ßç‡¶Ø ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶ø‡¶§ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!");
                        }
                    });
                case 'contact':
                    return renderAdminForm({
                        title: '‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó‡ßá‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø',
                        fields: [
                            { id: 'address', label: '‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ', value: state.siteData.contact.address, type: 'text' },
                            { id: 'phone', label: '‡¶´‡ßã‡¶® ‡ßß', value: state.siteData.contact.phone, type: 'text' },
                            { id: 'phone2', label: '‡¶´‡ßã‡¶® ‡ß®', value: state.siteData.contact.phone2, type: 'text' },
                            { id: 'email', label: '‡¶á‡¶Æ‡ßá‡¶≤', value: state.siteData.contact.email, type: 'email' },
                            { id: 'facebook', label: 'Facebook URL', value: state.siteData.contact.facebook, type: 'text' },
                            { id: 'twitter', label: 'Twitter URL', value: state.siteData.contact.twitter, type: 'text' },
                            { id: 'instagram', label: 'Instagram URL', value: state.siteData.contact.instagram, type: 'text' },
                        ],
                        onSave: async (formData) => {
                            state.siteData.contact = { ...formData }; // Simple object replacement
                            await saveFullSiteData();
                            alert("‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó‡ßá‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶ø‡¶§ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!");
                        }
                    });
                // --- List-based Sections ---
                case 'slides':
                    return renderAdminList({
                        title: '‡¶π‡¶ø‡¶∞‡ßã ‡¶∏‡ßç‡¶≤‡¶æ‡¶á‡¶°',
                        items: state.siteData.slides,
                        itemTemplate: (item) => `<p class="font-semibold">${item.title}</p><p class="text-sm text-gray-600">${item.subtitle}</p>`,
                        formFields: [
                            { id: 'title', label: '‡¶∂‡¶ø‡¶∞‡ßã‡¶®‡¶æ‡¶Æ', type: 'text', required: true },
                            { id: 'subtitle', label: '‡¶â‡¶™-‡¶∂‡¶ø‡¶∞‡ßã‡¶®‡¶æ‡¶Æ', type: 'text' },
                            { id: 'imageFile', label: '‡¶õ‡¶¨‡¶ø ‡¶Ü‡¶™‡¶≤‡ßã‡¶°', type: 'file', accept: 'image/*', required: true }
                        ],
                        onSave: handleAdminListSave('slides', ['title', 'subtitle'], 'imageFile')
                    });
                case 'objectives':
                     return renderAdminList({
                        title: '‡¶â‡¶¶‡ßç‡¶¶‡ßá‡¶∂‡ßç‡¶Ø',
                        items: state.siteData.objectives,
                        itemTemplate: (item) => `<p class="font-semibold">${item.icon} ${item.title}</p><p class="text-sm text-gray-600">${item.description}</p>`,
                        formFields: [
                            { id: 'icon', label: '‡¶Ü‡¶á‡¶ï‡¶® (Emoji)', type: 'text', required: true },
                            { id: 'title', label: '‡¶∂‡¶ø‡¶∞‡ßã‡¶®‡¶æ‡¶Æ', type: 'text', required: true },
                            { id: 'description', label: '‡¶¨‡¶ø‡¶¨‡¶∞‡¶£', type: 'textarea' }
                        ],
                        onSave: handleAdminListSave('objectives', ['icon', 'title', 'description'])
                    });
                case 'news':
                     return renderAdminList({
                        title: '‡¶∏‡¶Ç‡¶¨‡¶æ‡¶¶ ‡¶ì ‡¶á‡¶≠‡ßá‡¶®‡ßç‡¶ü',
                        items: state.siteData.newsAndEvents,
                        itemTemplate: (item) => `<p class="font-semibold">${item.title}</p><p class="text-sm text-gray-600">${item.excerpt}</p>`,
                        formFields: [
                            { id: 'title', label: '‡¶∂‡¶ø‡¶∞‡ßã‡¶®‡¶æ‡¶Æ', type: 'text', required: true },
                            { id: 'excerpt', label: '‡¶∏‡¶Ç‡¶ï‡ßç‡¶∑‡¶ø‡¶™‡ßç‡¶§ ‡¶¨‡¶ø‡¶¨‡¶∞‡¶£', type: 'textarea', required: true },
                            { id: 'content', label: '‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§ ‡¶¨‡¶ø‡¶¨‡¶∞‡¶£', type: 'textarea' },
                            { id: 'type', label: '‡¶ß‡¶∞‡¶®', type: 'select', options: [{value: 'news', label: '‡¶∏‡¶Ç‡¶¨‡¶æ‡¶¶'}, {value: 'event', label: '‡¶á‡¶≠‡ßá‡¶®‡ßç‡¶ü'}, {value: 'announcement', label: '‡¶ò‡ßã‡¶∑‡¶£‡¶æ'}] },
                            { id: 'date', label: '‡¶™‡ßç‡¶∞‡¶ï‡¶æ‡¶∂‡ßá‡¶∞ ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ', type: 'text', placeholder: '‡¶Ø‡ßá‡¶Æ‡¶®: ‡ßß‡ß´ ‡¶°‡¶ø‡¶∏‡ßá‡¶Æ‡ßç‡¶¨‡¶∞ ‡ß®‡ß¶‡ß®‡ß™' },
                            { id: 'eventDate', label: '‡¶á‡¶≠‡ßá‡¶®‡ßç‡¶ü‡ßá‡¶∞ ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ', type: 'text', placeholder: '‡¶Ø‡ßá‡¶Æ‡¶®: ‡ß®‡ß¶-‡ß®‡ß® ‡¶´‡ßá‡¶¨‡ßç‡¶∞‡ßÅ‡¶Ø‡¶º‡¶æ‡¶∞‡¶ø ‡ß®‡ß¶‡ß®‡ß´' },
                            { id: 'location', label: '‡¶∏‡ßç‡¶•‡¶æ‡¶®', type: 'text' },
                            { id: 'time', label: '‡¶∏‡¶Æ‡¶Ø‡¶º', type: 'text' },
                            { id: 'author', label: '‡¶≤‡ßá‡¶ñ‡¶ï', type: 'text' },
                            { id: 'category', label: '‡¶¨‡¶ø‡¶≠‡¶æ‡¶ó', type: 'text' },
                            { id: 'imageFile', label: '‡¶õ‡¶¨‡¶ø ‡¶Ü‡¶™‡¶≤‡ßã‡¶°', type: 'file', accept: 'image/*' }
                        ],
                        onSave: handleAdminListSave('newsAndEvents', 
                            ['title', 'excerpt', 'content', 'type', 'date', 'eventDate', 'location', 'time', 'author', 'category'], 
                            'imageFile', 'image'
                        )
                    });
                case 'gallery':
                    return renderAdminList({
                        title: '‡¶´‡¶ü‡ßã ‡¶ó‡ßç‡¶Ø‡¶æ‡¶≤‡¶æ‡¶∞‡¶ø',
                        items: state.siteData.gallery,
                        itemTemplate: (item) => `<img src="${item.image}" class="w-16 h-10 object-cover rounded mr-4"><p class="font-semibold">${item.title}</p>`,
                        formFields: [
                            { id: 'title', label: '‡¶∂‡¶ø‡¶∞‡ßã‡¶®‡¶æ‡¶Æ', type: 'text', required: true },
                            { id: 'description', label: '‡¶¨‡¶ø‡¶¨‡¶∞‡¶£', type: 'text' },
                            { id: 'imageFile', label: '‡¶õ‡¶¨‡¶ø ‡¶Ü‡¶™‡¶≤‡ßã‡¶°', type: 'file', accept: 'image/*', required: true }
                        ],
                        onSave: handleAdminListSave('gallery', ['title', 'description'], 'imageFile')
                    });
                default:
                    return 'Invalid section';
            }
        }
        
        // --- ADMIN: Generic Form Renderer ---
        function renderAdminForm({ title, fields, onSave }) {
            const formId = `admin-form-${title.replace(' ', '-')}`;
            
            // Attach save handler to window
            window[`${formId}_save`] = async (event) => {
                event.preventDefault();
                const form = document.getElementById(formId);
                const formData = {};
                const files = {};
                
                fields.forEach(field => {
                    if (field.type === 'file') {
                        files[field.id] = form[field.id].files[0];
                    } else {
                        formData[field.id] = form[field.id].value;
                    }
                });
                
                await onSave(formData, files);
            };

            return `
                <form id="${formId}" class="bg-white p-6 rounded-xl shadow-lg" onsubmit="${formId}_save(event); return false;">
                    <h2 class="text-2xl font-semibold mb-6">${title}</h2>
                    <div class="space-y-4">
                        ${fields.map(field => {
                            if (field.type === 'textarea') {
                                return `
                                    <div>
                                        <label for="${field.id}" class="block text-sm font-medium text-gray-700 mb-1">${field.label}</label>
                                        <textarea id="${field.id}" rows="6" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500">${field.value}</textarea>
                                    </div>
                                `;
                            }
                            if (field.type === 'file') {
                                return `
                                    <div>
                                        <label for="${field.id}" class="block text-sm font-medium text-gray-700 mb-1">${field.label}</label>
                                        <input type="${field.type}" id="${field.id}" accept="${field.accept || '*'}"
                                            class="w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 cursor-pointer">
                                        ${field.value ? `<p class="text-xs text-gray-500 mt-1">‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶®: ${field.value}</p>` : ''}
                                    </div>
                                `;
                            }
                            // Default to 'text' or other input types
                            return `
                                <div>
                                    <label for="${field.id}" class="block text-sm font-medium text-gray-700 mb-1">${field.label}</label>
                                    <input type="${field.type}" id="${field.id}" value="${field.value}" ${field.disabled ? 'disabled' : ''}
                                        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 ${field.disabled ? 'bg-gray-100' : ''}">
                                </div>
                            `;
                        }).join('')}
                    </div>
                    <div class="mt-6">
                        <button type="submit" ${state.isUploading ? 'disabled' : ''}
                            class="bg-green-600 text-white px-8 py-3 rounded-full hover:bg-green-700 transition shadow-lg flex items-center justify-center w-full md:w-auto disabled:bg-gray-400">
                            ${state.isUploading ? '<span class="loader-small"></span> ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...' : '<i class="fas fa-save mr-2"></i> ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®'}
                        </button>
                    </div>
                </form>
            `;
        }

        // --- ADMIN: Generic List/Form Handler ---
        function renderAdminList({ title, items, itemTemplate, formFields, onSave }) {
            const formId = `admin-form-${title.replace(' ', '-')}`;
            
            // Attach save handler to window
            window[`${formId}_save`] = async (event) => {
                event.preventDefault();
                const form = document.getElementById(formId);
                const formData = {};
                const files = {};
                
                formFields.forEach(field => {
                    if (field.type === 'file') {
                        files[field.id] = form[field.id].files[0];
                    } else if (field.type === 'select') {
                        formData[field.id] = form[field.id].value;
                    } else {
                        formData[field.id] = form[field.id].value;
                    }
                });
                
                await onSave(formData, files);
                // Clear form
                form.reset();
                state.adminEditId = null;
                render();
            };

            // Attach edit handler
            window[`${formId}_edit`] = (id) => {
                const item = state.siteData[state.adminSection].find(i => i.id === id);
                if (!item) return;
                
                state.adminEditId = id;
                // Populate form
                const form = document.getElementById(formId);
                formFields.forEach(field => {
                    if (field.type !== 'file' && item[field.id] !== undefined) {
                        form[field.id].value = item[field.id];
                    }
                });
                form.scrollIntoView({ behavior: 'smooth' });
            };

            // Attach delete handler
            window[`${formId}_delete`] = (id) => {
                if (!confirm('‡¶Ü‡¶™‡¶®‡¶ø ‡¶ï‡¶ø ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶è‡¶á ‡¶Ü‡¶á‡¶ü‡ßá‡¶Æ‡¶ü‡¶ø ‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡¶§‡ßá ‡¶ö‡¶æ‡¶®?')) return;
                state.siteData[state.adminSection] = state.siteData[state.adminSection].filter(item => item.id !== id);
                saveFullSiteData();
                render();
            };

            return `
                <div class="grid lg:grid-cols-3 gap-6">
                    <!-- Form -->
                    <div class="lg:col-span-1">
                        <form id="${formId}" class="bg-white p-6 rounded-xl shadow-lg space-y-4" onsubmit="${formId}_save(event); return false;">
                            <h2 class="text-2xl font-semibold mb-4">${state.adminEditId ? '‡¶Ü‡¶á‡¶ü‡ßá‡¶Æ ‡¶∏‡¶Æ‡ßç‡¶™‡¶æ‡¶¶‡¶®‡¶æ' : '‡¶®‡¶§‡ßÅ‡¶® ‡¶Ü‡¶á‡¶ü‡ßá‡¶Æ ‡¶Ø‡ßã‡¶ó'}</h2>
                            
                            ${formFields.map(field => {
                                if (field.type === 'textarea') {
                                    return `
                                        <div>
                                            <label for="${field.id}" class="block text-sm font-medium text-gray-700 mb-1">${field.label}</label>
                                            <textarea id="${field.id}" rows="4" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500" ${field.required ? 'required' : ''}></textarea>
                                        </div>
                                    `;
                                }
                                if (field.type === 'file') {
                                    return `
                                        <div>
                                            <label for="${field.id}" class="block text-sm font-medium text-gray-700 mb-1">${field.label}</label>
                                            <input type="file" id="${field.id}" accept="${field.accept || '*'}"
                                                class="w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 cursor-pointer" 
                                                ${field.required && !state.adminEditId ? 'required' : ''}>
                                            ${state.adminEditId ? '<p class="text-xs text-gray-500 mt-1">‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶ï‡¶∞‡¶§‡ßá ‡¶®‡¶§‡ßÅ‡¶® ‡¶´‡¶æ‡¶á‡¶≤ ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</p>' : ''}
                                        </div>
                                    `;
                                }
                                if (field.type === 'select') {
                                    return `
                                        <div>
                                            <label for="${field.id}" class="block text-sm font-medium text-gray-700 mb-1">${field.label}</label>
                                            <select id="${field.id}" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500">
                                                ${field.options.map(opt => `<option value="${opt.value}">${opt.label}</option>`).join('')}
                                            </select>
                                        </div>
                                    `;
                                }
                                // Default to 'text'
                                return `
                                    <div>
                                        <label for="${field.id}" class="block text-sm font-medium text-gray-700 mb-1">${field.label}</label>
                                        <input type="${field.type}" id="${field.id}" placeholder="${field.placeholder || ''}"
                                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500" ${field.required ? 'required' : ''}>
                                    </div>
                                `;
                            }).join('')}
                            
                            <div class="pt-4 flex flex-col sm:flex-row gap-2">
                                <button type="submit" ${state.isUploading ? 'disabled' : ''}
                                    class="flex-1 bg-green-600 text-white px-6 py-3 rounded-full hover:bg-green-700 transition shadow-lg flex items-center justify-center disabled:bg-gray-400">
                                    ${state.isUploading ? '<span class="loader-small"></span>' : '<i class="fas fa-save mr-2"></i>'}
                                    ${state.adminEditId ? '‡¶Ü‡¶™‡¶°‡ßá‡¶ü' : '‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£'}
                                </button>
                                ${state.adminEditId ? `
                                    <button type="button" onclick="state.adminEditId = null; document.getElementById('${formId}').reset(); render();"
                                        class="flex-1 bg-gray-500 text-white px-6 py-3 rounded-full hover:bg-gray-600 transition flex items-center justify-center">
                                        <i class="fas fa-times mr-2"></i> ‡¶¨‡¶æ‡¶§‡¶ø‡¶≤
                                    </button>
                                ` : ''}
                            </div>
                        </form>
                    </div>

                    <!-- List -->
                    <div class="lg:col-span-2 bg-white p-6 rounded-xl shadow-lg">
                        <h2 class="text-2xl font-semibold mb-6">‡¶¨‡¶ø‡¶¶‡ßç‡¶Ø‡¶Æ‡¶æ‡¶® ${title}</h2>
                        <div class="space-y-3 max-h-[70vh] overflow-y-auto">
                            ${items.slice().reverse().map(item => `
                                <div class="flex items-center p-4 rounded-lg bg-gray-50 border">
                                    <div class="flex-1 min-w-0">
                                        <div class="flex items-center">
                                            ${itemTemplate(item)}
                                        </div>
                                    </div>
                                    <div class="flex-shrink-0 ml-4 space-x-2">
                                        <button onclick="${formId}_edit(${item.id})" class="text-blue-600 hover:text-blue-800" title="Edit">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button onclick="${formId}_delete(${item.id})" class="text-red-600 hover:text-red-800" title="Delete">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </div>
                            `).join('')}
                            ${items.length === 0 ? '<p class="text-gray-500">‡¶ï‡ßã‡¶®‡ßã ‡¶Ü‡¶á‡¶ü‡ßá‡¶Æ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø‡•§</p>' : ''}
                        </div>
                    </div>
                </div>
            `;
        }

        // --- ADMIN: Generic Save Handler Factory ---
        function handleAdminListSave(sectionKey, textFields, fileFieldKey, imageFieldKey = 'image') {
            return async (formData, files) => {
                state.isUploading = true; render();
                
                let newItem;
                const file = files[fileFieldKey];
                
                if (state.adminEditId) {
                    // --- Editing existing item ---
                    newItem = state.siteData[sectionKey].find(i => i.id === state.adminEditId);
                    if (!newItem) return;
                    
                    // Update text fields
                    textFields.forEach(key => newItem[key] = formData[key]);
                    
                    // Check for new file upload
                    if (file) {
                        const newImageUrl = await uploadFile(file, sectionKey);
                        // TODO: Delete old image from storage
                        newItem[imageFieldKey] = newImageUrl;
                    }
                } else {
                    // --- Adding new item ---
                    newItem = { id: Date.now() };
                    
                    // Add text fields
                    textFields.forEach(key => newItem[key] = formData[key]);
                    
                    // Upload file and add URL
                    const newImageUrl = await uploadFile(file, sectionKey);
                    newItem[imageFieldKey] = newImageUrl;

                    state.siteData[sectionKey].push(newItem);
                }
                
                await saveFullSiteData();
                state.isUploading = false;
                state.adminEditId = null;
                alert("‡¶Ü‡¶á‡¶ü‡ßá‡¶Æ ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶ø‡¶§ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!");
            };
        }

        // --- PUBLIC: Render Login Modal ---
        function renderLoginModal() {
            return `
                <div class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 p-4">
                    <div class="bg-white rounded-xl p-8 max-w-md w-full shadow-2xl relative">
                        <button onclick="state.showLogin = false; clearLoginFields(); render();" class="absolute top-4 right-4 text-gray-500 hover:text-gray-700">
                            <i class="fas fa-times text-2xl"></i>
                        </button>
                        
                        <div class="mb-6">
                            <div class="flex border-b">
                                <button onclick="state.loginTab = 'login'; render();" class="flex-1 py-3 text-center font-semibold ${state.loginTab === 'login' ? 'text-green-600 border-b-2 border-green-600' : 'text-gray-500'}">
                                    ‡¶≤‡¶ó ‡¶á‡¶®
                                </button>
                                <button onclick="state.loginTab = 'signup'; render();" class="flex-1 py-3 text-center font-semibold ${state.loginTab === 'signup' ? 'text-green-600 border-b-2 border-green-600' : 'text-gray-500'}">
                                    ‡¶∏‡¶æ‡¶á‡¶® ‡¶Ü‡¶™
                                </button>
                            </div>
                        </div>

                        <h2 class="text-2xl font-bold text-gray-800 text-center mb-6">
                            ${state.loginTab === 'login' ? '‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶≤‡¶ó‡¶á‡¶®' : '‡¶®‡¶§‡ßÅ‡¶® ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü'}
                        </h2>
                        
                        ${state.loginTab === 'signup' ? `
                            <p class="text-sm text-center text-gray-600 mb-4">
                                ‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡¶¨‡¶æ‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶è‡¶ï‡¶ü‡¶ø ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®‡•§
                            </p>
                        ` : ''}

                        <div class="space-y-4">
                            <input type="email" placeholder="‡¶á‡¶Æ‡ßá‡¶≤" 
                                value="${state.loginEmail}"
                                onchange="state.loginEmail = this.value"
                                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500">
                            <input type="password" placeholder="‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶°" 
                                value="${state.loginPassword}"
                                onchange="state.loginPassword = this.value"
                                onkeypress="if(event.key === 'Enter') ${state.loginTab === 'login' ? 'handleLogin()' : 'handleSignUp()'}"
                                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500">
                        </div>

                        ${state.loginError ? `<p class="text-red-500 text-sm mt-4 text-center">${state.loginError}</p>` : ''}
                        
                        <div class="mt-6">
                            ${state.loginTab === 'login' ? `
                                <button onclick="handleLogin()" class="w-full bg-green-600 text-white px-4 py-3 rounded-lg hover:bg-green-700 font-medium transition">
                                    ‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®
                                </button>
                            ` : `
                                <button onclick="handleSignUp()" class="w-full bg-blue-600 text-white px-4 py-3 rounded-lg hover:bg-blue-700 font-medium transition">
                                    ‡¶∏‡¶æ‡¶á‡¶® ‡¶Ü‡¶™ ‡¶ï‡¶∞‡ßÅ‡¶®
                                </button>
                            `}
                        </div>
                    </div>
                </div>
            `;
        }

        // --- PUBLIC: Render Public Website ---
        function renderPublicWebsite() {
            const filteredNews = getFilteredNews();
            
            return `
                <!-- Header -->
                <header class="bg-white shadow-lg fixed w-full top-0 z-50">
                    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                        <div class="flex justify-between items-center h-20">
                            <div class="flex items-center space-x-4">
                                <img src="${state.siteData.logo}" alt="Logo" class="h-14 w-auto object-contain">
                                <div>
                                    <h1 class="text-xl font-bold text-green-800">${state.siteData.siteName}</h1>
                                    <p class="text-sm text-gray-600">${state.siteData.siteNameEn}</p>
                                </div>
                            </div>

                            <nav class="hidden lg:flex items-center space-x-6">
                                <button onclick="scrollToSection('hero')" class="text-gray-700 hover:text-green-600 font-medium">‡¶π‡ßã‡¶Æ</button>
                                <button onclick="scrollToSection('about')" class="text-gray-700 hover:text-green-600 font-medium">‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶ï‡¶æ‡¶∞‡¶æ</button>
                                <button onclick="scrollToSection('mission')" class="text-gray-700 hover:text-green-600 font-medium">‡¶≤‡¶ï‡ßç‡¶∑‡ßç‡¶Ø</button>
                                <button onclick="scrollToSection('objectives')" class="text-gray-700 hover:text-green-600 font-medium">‡¶â‡¶¶‡ßç‡¶¶‡ßá‡¶∂‡ßç‡¶Ø</button>
                                <button onclick="scrollToSection('news')" class="text-gray-700 hover:text-green-600 font-medium">‡¶∏‡¶Ç‡¶¨‡¶æ‡¶¶</button>
                                <button onclick="scrollToSection('gallery')" class="text-gray-700 hover:text-green-600 font-medium">‡¶ó‡ßç‡¶Ø‡¶æ‡¶≤‡¶æ‡¶∞‡¶ø</button>
                                <button onclick="scrollToSection('contact')" class="text-gray-700 hover:text-green-600 font-medium">‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó</button>
                                
                                ${state.isAdmin ? `
                                    <button onclick="state.view = 'admin'; state.adminSection = 'dashboard'; render();" 
                                        class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">
                                        <i class="fas fa-user-shield mr-2"></i> ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤
                                    </button>
                                    <button onclick="handleLogout()" 
                                        class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700">‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü</button>
                                ` : `
                                    <button onclick="state.showLogin = true; render();" 
                                        class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700">‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶≤‡¶ó‡¶á‡¶®</button>
                                `}
                            </nav>

                            <button onclick="state.isMenuOpen = !state.isMenuOpen; render();" class="lg:hidden text-gray-700">
                                <i class="fas fa-${state.isMenuOpen ? 'times' : 'bars'} text-2xl"></i>
                            </button>
                        </div>
                    </div>

                    ${state.isMenuOpen ? `
                        <div class="lg:hidden bg-white border-t shadow-lg">
                            <div class="px-4 py-3 space-y-2">
                                <button onclick="scrollToSection('hero')" class="block w-full text-left py-2 text-gray-700 hover:text-green-600">‡¶π‡ßã‡¶Æ</button>
                                <button onclick="scrollToSection('about')" class="block w-full text-left py-2 text-gray-700 hover:text-green-600">‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶ï‡¶æ‡¶∞‡¶æ</button>
                                <button onclick="scrollToSection('mission')" class="block w-full text-left py-2 text-gray-700 hover:text-green-600">‡¶≤‡¶ï‡ßç‡¶∑‡ßç‡¶Ø</button>
                                <button onclick="scrollToSection('objectives')" class="block w-full text-left py-2 text-gray-700 hover:text-green-600">‡¶â‡¶¶‡ßç‡¶¶‡ßá‡¶∂‡ßç‡¶Ø</button>
                                <button onclick="scrollToSection('news')" class="block w-full text-left py-2 text-gray-700 hover:text-green-600">‡¶∏‡¶Ç‡¶¨‡¶æ‡¶¶</button>
                                <button onclick="scrollToSection('gallery')" class="block w-full text-left py-2 text-gray-700 hover:text-green-600">‡¶ó‡ßç‡¶Ø‡¶æ‡¶≤‡¶æ‡¶∞‡¶ø</button>
                                <button onclick="scrollToSection('contact')" class="block w-full text-left py-2 text-gray-700 hover:text-green-600">‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó</button>
                                <div class="border-t pt-2">
                                ${state.isAdmin ? `
                                    <button onclick="state.view = 'admin'; state.adminSection = 'dashboard'; render();" 
                                        class="block w-full text-left py-2 text-blue-600 font-semibold">‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤</button>
                                    <button onclick="handleLogout()" 
                                        class="block w-full text-left py-2 text-red-600 font-semibold">‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü</button>
                                ` : `
                                    <button onclick="state.showLogin = true; render();" 
                                        class="block w-full text-left py-2 text-green-600 font-semibold">‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶≤‡¶ó‡¶á‡¶®</button>
                                `}
                                </div>
                            </div>
                        </div>
                    ` : ''}
                </header>

                <!-- Hero Slider -->
                <section id="hero" class="pt-20 relative h-screen overflow-hidden">
                    ${state.siteData.slides.map((slide, index) => `
                        <div class="absolute inset-0 transition-opacity duration-1000 ${index === state.currentSlide ? 'opacity-100' : 'opacity-0'}">
                            <img src="${slide.image}" alt="${slide.title}" class="w-full h-full object-cover">
                            <div class="absolute inset-0 bg-gradient-to-r from-green-900/90 to-green-700/70"></div>
                            <div class="absolute inset-0 flex items-center justify-center text-white text-center px-4">
                                <div class="max-w-4xl">
                                    <h1 class="text-4xl md:text-6xl font-bold mb-4 animate-fade-in drop-shadow-lg">${slide.title}</h1>
                                    <p class="text-xl md:text-2xl mb-8 animate-fade-in drop-shadow-md">${slide.subtitle}</p>
                                    <button onclick="scrollToSection('about')" 
                                        class="bg-white text-green-700 px-8 py-4 rounded-full text-lg font-semibold hover:bg-green-50 transition shadow-lg hover:shadow-xl transform hover:scale-105">
                                        ‡¶Ü‡¶∞‡¶ì ‡¶ú‡¶æ‡¶®‡ßÅ‡¶®
                                    </button>
                                </div>
                            </div>
                        </div>
                    `).join('')}
                    
                    ${state.siteData.slides.length > 1 ? `
                        <button onclick="state.currentSlide = (state.currentSlide - 1 + state.siteData.slides.length) % state.siteData.slides.length; render();" 
                            class="absolute left-4 top-1/2 transform -translate-y-1/2 bg-white/30 hover:bg-white/50 backdrop-blur-sm p-3 rounded-full transition z-10">
                            <i class="fas fa-chevron-left text-white text-xl"></i>
                        </button>
                        <button onclick="state.currentSlide = (state.currentSlide + 1) % state.siteData.slides.length; render();" 
                            class="absolute right-4 top-1/2 transform -translate-y-1/2 bg-white/30 hover:bg-white/50 backdrop-blur-sm p-3 rounded-full transition z-10">
                            <i class="fas fa-chevron-right text-white text-xl"></i>
                        </button>
                        <div class="absolute bottom-8 left-1/2 transform -translate-x-1/2 flex space-x-2 z-10">
                            ${state.siteData.slides.map((_, index) => `
                                <button onclick="state.currentSlide = ${index}; render();" 
                                    class="transition-all ${index === state.currentSlide ? 'w-12 h-3 bg-white rounded-full' : 'w-3 h-3 bg-white/50 rounded-full hover:bg-white/75'}">
                                </button>
                            `).join('')}
                        </div>
                    ` : ''}
                </section>

                <!-- About Section -->
                <section id="about" class="py-20 bg-white">
                    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                        <div class="grid md:grid-cols-2 gap-12 items-center">
                            <div>
                                <h2 class="text-4xl font-bold mb-6 text-green-800 relative inline-block">
                                    ${state.siteData.about.title}
                                    <span class="absolute -bottom-2 left-0 w-20 h-1 bg-green-600 rounded"></span>
                                </h2>
                                <p class="text-lg text-gray-700 leading-relaxed mb-6">${state.siteData.about.content}</p>
                                <button onclick="scrollToSection('contact')" 
                                    class="bg-green-600 text-white px-8 py-3 rounded-full hover:bg-green-700 transition shadow-lg hover:shadow-xl transform hover:scale-105">
                                    ‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®
                                </button>
                            </div>
                            <div>
                                <img src="${state.siteData.about.image}" alt="About" 
                                    class="rounded-2xl shadow-2xl w-full h-96 object-cover transform hover:scale-105 transition duration-500">
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Mission Section -->
                <section id="mission" class="py-20 bg-gradient-to-br from-green-50 to-green-100">
                    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                        <h2 class="text-4xl font-bold text-center mb-12 text-green-800 relative inline-block w-full">
                            ${state.siteData.mission.title}
                            <span class="absolute -bottom-2 left-1/2 transform -translate-x-1/2 w-20 h-1 bg-green-600 rounded"></span>
                        </h2>
                        
                        <div class="grid md:grid-cols-2 gap-8">
                            <div class="bg-white p-8 rounded-2xl shadow-xl hover:shadow-2xl transition transform hover:-translate-y-2">
                                <div class="flex items-center mb-6">
                                    <div class="bg-green-100 p-4 rounded-full mr-4">
                                        <i class="fas fa-eye text-green-600 text-3xl"></i>
                                    </div>
                                    <h3 class="text-2xl font-bold text-green-700">‡¶¶‡ßÉ‡¶∑‡ßç‡¶ü‡¶ø‡¶≠‡¶ô‡ßç‡¶ó‡¶ø</h3>
                                </div>
                                <p class="text-gray-700 leading-relaxed text-lg">${state.siteData.mission.vision}</p>
                            </div>
                            
                            <div class="bg-white p-8 rounded-2xl shadow-xl hover:shadow-2xl transition transform hover:-translate-y-2">
                                <div class="flex items-center mb-6">
                                    <div class="bg-green-100 p-4 rounded-full mr-4">
                                        <i class="fas fa-bullseye text-green-600 text-3xl"></i>
                                    </div>
                                    <h3 class="text-2xl font-bold text-green-700">‡¶Æ‡¶ø‡¶∂‡¶®</h3>
                                </div>
                                <p class="text-gray-700 leading-relaxed text-lg">${state.siteData.mission.mission}</p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Objectives Section -->
                <section id="objectives" class="py-20 bg-white">
                    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                        <h2 class="text-4xl font-bold text-center mb-12 text-green-800 relative inline-block w-full">
                            ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶â‡¶¶‡ßç‡¶¶‡ßá‡¶∂‡ßç‡¶Ø
                            <span class="absolute -bottom-2 left-1/2 transform -translate-x-1/2 w-20 h-1 bg-green-600 rounded"></span>
                        </h2>
                        
                        <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-8">
                            ${state.siteData.objectives.map((obj) => `
                                <div class="bg-gradient-to-br from-green-50 to-white p-6 rounded-2xl shadow-lg hover:shadow-2xl transition transform hover:-translate-y-2 border-t-4 border-green-600">
                                    <div class="text-5xl mb-4">${obj.icon}</div>
                                    <h3 class="text-xl font-bold mb-3 text-green-800">${obj.title}</h3>
                                    <p class="text-gray-700 leading-relaxed">${obj.description}</p>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </section>

                <!-- News Section -->
                <section id="news" class="py-20 bg-gray-50">
                    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                        <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4">
                            <h2 class="text-4xl font-bold text-green-800 relative inline-block">
                                ‡¶∏‡¶Ç‡¶¨‡¶æ‡¶¶ ‡¶ì ‡¶á‡¶≠‡ßá‡¶®‡ßç‡¶ü
                                <span class="absolute -bottom-2 left-0 w-20 h-1 bg-green-600 rounded"></span>
                            </h2>
                        </div>

                        <div class="flex flex-col md:flex-row gap-4 mb-8">
                            <div class="flex flex-wrap gap-3">
                                ${[
                                    { value: 'all', label: '‡¶∏‡¶ï‡¶≤', color: 'green' },
                                    { value: 'news', label: '‡¶∏‡¶Ç‡¶¨‡¶æ‡¶¶', color: 'blue' },
                                    { value: 'event', label: '‡¶á‡¶≠‡ßá‡¶®‡ßç‡¶ü', color: 'purple' },
                                    { value: 'announcement', label: '‡¶ò‡ßã‡¶∑‡¶£‡¶æ', color: 'orange' }
                                ].map(filter => `
                                    <button onclick="state.newsFilter = '${filter.value}'; render();" 
                                        class="px-6 py-2 rounded-full font-medium transition ${
                                            state.newsFilter === filter.value
                                                ? `bg-${filter.color}-600 text-white shadow-lg`
                                                : 'bg-white text-gray-700 hover:bg-gray-100 shadow'
                                        }">
                                        ${filter.label}
                                    </button>
                                `).join('')}
                            </div>
                            <div class="flex-1 relative">
                                <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                                <input type="text" placeholder="‡¶∏‡¶Ç‡¶¨‡¶æ‡¶¶ ‡¶Ö‡¶®‡ßÅ‡¶∏‡¶®‡ßç‡¶ß‡¶æ‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®..." 
                                    value="${state.searchQuery}"
                                    oninput="state.searchQuery = this.value; render();"
                                    class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-full focus:ring-2 focus:ring-green-500 focus:border-transparent">
                            </div>
                        </div>

                        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                            ${filteredNews.map(item => `
                                <div class="bg-white rounded-2xl overflow-hidden shadow-lg hover:shadow-2xl transition transform hover:-translate-y-2">
                                    <div class="relative h-48 overflow-hidden">
                                        <img src="${item.image}" alt="${item.title}" 
                                            class="w-full h-full object-cover hover:scale-110 transition duration-500">
                                        <div class="absolute top-4 left-4">
                                            <span class="px-4 py-1 rounded-full text-xs font-bold text-white ${
                                                item.type === 'news' ? 'bg-blue-600' :
                                                item.type === 'event' ? 'bg-purple-600' : 'bg-orange-600'
                                            }">
                                                ${item.type === 'news' ? '‡¶∏‡¶Ç‡¶¨‡¶æ‡¶¶' : item.type === 'event' ? '‡¶á‡¶≠‡ßá‡¶®‡ßç‡¶ü' : '‡¶ò‡ßã‡¶∑‡¶£‡¶æ'}
                                            </span>
                                        </div>
                                    </div>
                                    
                                    <div class="p-6">
                                        <div class="flex items-center text-gray-500 text-sm mb-3 gap-2">
                                            <i class="far fa-calendar-alt"></i>
                                            <span>${item.date}</span>
                                            <span>‚Ä¢</span>
                                            <i class="fas fa-tag"></i>
                                            <span class="text-green-600 font-medium">${item.category}</span>
                                        </div>
                                        <h3 class="text-xl font-bold mb-3 text-gray-800 line-clamp-2">${item.title}</h3>
                                        <p class="text-gray-600 mb-4 line-clamp-3 leading-relaxed">${item.excerpt}</p>
                                        <button onclick="state.selectedNews = ${JSON.stringify(item).replace(/"/g, '&quot;')}; render();" 
                                            class="text-green-600 hover:text-green-700 font-semibold flex items-center group">
                                            ‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§ ‡¶™‡¶°‡¶º‡ßÅ‡¶®
                                            <i class="fas fa-chevron-right ml-1 group-hover:translate-x-1 transition"></i>
                                        </button>
                                    </div>
                                </div>
                            `).join('')}
                        </div>

                        ${filteredNews.length === 0 ? `
                            <div class="text-center py-16">
                                <i class="fas fa-search text-gray-300 text-6xl mb-4"></i>
                                <p class="text-gray-500 text-xl">‡¶ï‡ßã‡¶®‡ßã ‡¶´‡¶≤‡¶æ‡¶´‡¶≤ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø</p>
                            </div>
                        ` : ''}
                    </div>
                </section>

                <!-- News Detail Modal -->
                ${state.selectedNews ? `
                    <div class="fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4 overflow-y-auto">
                        <div class="bg-white rounded-2xl max-w-4xl w-full my-8 shadow-2xl">
                            <button onclick="state.selectedNews = null; render();" 
                                class="absolute top-4 right-4 bg-white text-gray-700 hover:text-gray-900 rounded-full p-2 shadow-lg z-10">
                                <i class="fas fa-times text-xl"></i>
                            </button>

                            <div class="relative h-80">
                                <img src="${state.selectedNews.image}" alt="${state.selectedNews.title}" 
                                    class="w-full h-full object-cover rounded-t-2xl">
                                <div class="absolute inset-0 bg-gradient-to-t from-black/70 via-transparent to-transparent rounded-t-2xl"></div>
                                <div class="absolute bottom-6 left-6">
                                    <span class="px-4 py-2 rounded-full text-sm font-bold text-white ${
                                        state.selectedNews.type === 'news' ? 'bg-blue-600' :
                                        state.selectedNews.type === 'event' ? 'bg-purple-600' : 'bg-orange-600'
                                    }">
                                        ${state.selectedNews.type === 'news' ? '‡¶∏‡¶Ç‡¶¨‡¶æ‡¶¶' : 
                                          state.selectedNews.type === 'event' ? '‡¶á‡¶≠‡ßá‡¶®‡ßç‡¶ü' : '‡¶ò‡ßã‡¶∑‡¶£‡¶æ'}
                                    </span>
                                </div>
                            </div>

                            <div class="p-8">
                                <h2 class="text-3xl md:text-4xl font-bold mb-4 text-gray-900">${state.selectedNews.title}</h2>

                                <div class="flex flex-wrap items-center gap-4 text-gray-600 mb-6 pb-6 border-b">
                                    <div class="flex items-center">
                                        <i class="far fa-calendar-alt mr-2"></i>
                                        <span>${state.selectedNews.date}</span>
                                    </div>
                                    <div class="flex items-center">
                                        <i class="far fa-user mr-2"></i>
                                        <span>${state.selectedNews.author}</span>
                                    </div>
                                    <div class="flex items-center">
                                        <i class="fas fa-tag mr-2"></i>
                                        <span class="text-green-600 font-semibold">${state.selectedNews.category}</span>
                                    </div>
                                </div>

                                ${state.selectedNews.type === 'event' && state.selectedNews.eventDate ? `
                                    <div class="bg-green-50 rounded-xl p-6 mb-6">
                                        <h3 class="text-xl font-bold text-green-800 mb-4">‡¶á‡¶≠‡ßá‡¶®‡ßç‡¶ü‡ßá‡¶∞ ‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§</h3>
                                        <div class="space-y-3">
                                            <div class="flex items-start">
                                                <i class="far fa-calendar-check text-green-600 mr-3 mt-1"></i>
                                                <div>
                                                    <p class="font-semibold text-gray-700">‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ</p>
                                                    <p class="text-gray-600">${state.selectedNews.eventDate}</p>
                                                </div>
                                            </div>
                                            ${state.selectedNews.time ? `
                                                <div class="flex items-start">
                                                    <i class="far fa-clock text-green-600 mr-3 mt-1"></i>
                                                    <div>
                                                        <p class="font-semibold text-gray-700">‡¶∏‡¶Æ‡¶Ø‡¶º</p>
                                                        <p class="text-gray-600">${state.selectedNews.time}</p>
                                                    </div>
                                                </div>
                                            ` : ''}
                                            ${state.selectedNews.location ? `
                                                <div class="flex items-start">
                                                    <i class="fas fa-map-marker-alt text-green-600 mr-3 mt-1"></i>
                                                    <div>
                                                        <p class="font-semibold text-gray-700">‡¶∏‡ßç‡¶•‡¶æ‡¶®</p>
                                                        <p class="text-gray-600">${state.selectedNews.location}</p>
                                                    </div>
                                                </div>
                                            ` : ''}
                                        </div>
                                    </div>
                                ` : ''}

                                <div class="prose prose-lg max-w-none text-gray-700 leading-relaxed mb-8">
                                    <p>${state.selectedNews.content}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                ` : ''}

                <!-- Gallery Section -->
                <section id="gallery" class="py-20 bg-white">
                    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                        <div class="flex justify-between items-center mb-12">
                            <h2 class="text-4xl font-bold text-green-800 relative inline-block">
                                ‡¶´‡¶ü‡ßã ‡¶ó‡ßç‡¶Ø‡¶æ‡¶≤‡¶æ‡¶∞‡¶ø
                                <span class="absolute -bottom-2 left-0 w-20 h-1 bg-green-600 rounded"></span>
                            </h2>
                        </div>
                        
                        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                            ${state.siteData.gallery.map(item => `
                                <div class="relative group overflow-hidden rounded-2xl shadow-lg hover:shadow-2xl transition cursor-pointer">
                                    <img src="${item.image}" alt="${item.title}" 
                                        onerror="this.src='https://placehold.co/800x600/f0f0f0/a0a0a0?text=Image+Not+Found'"
                                        onclick="state.selectedImage = ${JSON.stringify(item).replace(/"/g, '&quot;')}; render();"
                                        class="w-full h-64 object-cover group-hover:scale-110 transition duration-500">
                                    <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-black/40 to-transparent opacity-0 group-hover:opacity-100 transition duration-300 flex items-end p-6">
                                        <div class="text-white">
                                            <h3 class="text-xl font-bold mb-2">${item.title}</h3>
                                            <p class="text-sm">${item.description}</p>
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </section>

                <!-- Gallery Modal -->
                ${state.selectedImage ? `
                    <div onclick="state.selectedImage = null; render();" 
                        class="fixed inset-0 bg-black/90 backdrop-blur-sm flex items-center justify-center z-50 p-4">
                        <div onclick="event.stopPropagation();" class="max-w-5xl w-full">
                            <img src="${state.selectedImage.image}" alt="${state.selectedImage.title}" 
                                onerror="this.src='https://placehold.co/1200x800/f0f0f0/a0a0a0?text=Image+Not+Found'"
                                class="w-full h-auto rounded-2xl shadow-2xl">
                            <div class="text-white mt-6 text-center">
                                <h3 class="text-3xl font-bold mb-2">${state.selectedImage.title}</h3>
                                <p class="text-lg">${state.selectedImage.description}</p>
                            </div>
                            <button onclick="state.selectedImage = null; render();" 
                                class="absolute top-4 right-4 bg-white text-gray-700 hover:text-gray-900 rounded-full p-3 shadow-lg">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                        </div>
                    </div>
                ` : ''}

                <!-- Contact Section -->
                <section id="contact" class="py-20 bg-gradient-to-br from-green-800 to-green-900 text-white">
                    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                        <h2 class="text-4xl font-bold text-center mb-12">‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®</h2>
                        
                        <div class="grid md:grid-cols-2 gap-12">
                            <div>
                                <h3 class="text-2xl font-bold mb-8">‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó‡ßá‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø</h3>
                                
                                <div class="space-y-6">
                                    <div class="flex items-start group">
                                        <div class="bg-white/20 p-3 rounded-lg mr-4 group-hover:bg-white/30 transition">
                                            <i class="fas fa-map-marker-alt text-2xl"></i>
                                        </div>
                                        <div class="flex-1">
                                            <h4 class="font-bold mb-2 text-lg">‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ</h4>
                                            <p class="text-green-100">${state.siteData.contact.address}</p>
                                        </div>
                                    </div>
                                    
                                    <div class="flex items-start group">
                                        <div class="bg-white/20 p-3 rounded-lg mr-4 group-hover:bg-white/30 transition">
                                            <i class="fas fa-phone text-2xl"></i>
                                        </div>
                                        <div class="flex-1">
                                            <h4 class="font-bold mb-2 text-lg">‡¶´‡ßã‡¶®</h4>
                                            <p class="text-green-100">${state.siteData.contact.phone}</p>
                                            <p class="text-green-100">${state.siteData.contact.phone2}</p>
                                        </div>
                                    </div>
                                    
                                    <div class="flex items-start group">
                                        <div class="bg-white/20 p-3 rounded-lg mr-4 group-hover:bg-white/30 transition">
                                            <i class="fas fa-envelope text-2xl"></i>
                                        </div>
                                        <div class="flex-1">
                                            <h4 class="font-bold mb-2 text-lg">‡¶á‡¶Æ‡ßá‡¶≤</h4>
                                            <p class="text-green-100">${state.siteData.contact.email}</p>
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <h4 class="font-bold mb-4 text-lg">‡¶∏‡ßã‡¶∂‡ßç‡¶Ø‡¶æ‡¶≤ ‡¶Æ‡¶ø‡¶°‡¶ø‡¶Ø‡¶º‡¶æ</h4>
                                        <div class="flex space-x-4">
                                            <a href="${state.siteData.contact.facebook}" target="_blank" rel="noopener noreferrer"
                                                class="bg-white/20 w-12 h-12 rounded-full flex items-center justify-center hover:bg-white/30 transition transform hover:scale-110">
                                                <i class="fab fa-facebook-f text-xl"></i>
                                            </a>
                                            <a href="${state.siteData.contact.twitter}" target="_blank" rel="noopener noreferrer"
                                                class="bg-white/20 w-12 h-12 rounded-full flex items-center justify-center hover:bg-white/30 transition transform hover:scale-110">
                                                <i class="fab fa-twitter text-xl"></i>
                                            </a>
                                            <a href="${state.siteData.contact.instagram}" target="_blank" rel="noopener noreferrer"
                                                class="bg-white/20 w-12 h-12 rounded-full flex items-center justify-center hover:bg-white/30 transition transform hover:scale-110">
                                                <i class="fab fa-instagram text-xl"></i>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div>
                                <h3 class="text-2xl font-bold mb-8">‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶™‡¶æ‡¶†‡¶æ‡¶®</h3>
                                <form class="space-y-4" onsubmit="event.preventDefault(); alert('‡¶´‡¶∞‡ßç‡¶Æ ‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶ü ‡¶∏‡¶´‡¶≤ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!');">
                                    <input type="text" placeholder="‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ" required
                                        class="w-full px-4 py-3 rounded-lg bg-white/10 border border-white/30 placeholder-white/70 text-white focus:outline-none focus:ring-2 focus:ring-white backdrop-blur-sm">
                                    <input type="email" placeholder="‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶á‡¶Æ‡ßá‡¶≤" required
                                        class="w-full px-4 py-3 rounded-lg bg-white/10 border border-white/30 placeholder-white/70 text-white focus:outline-none focus:ring-2 focus:ring-white backdrop-blur-sm">
                                    <input type="tel" placeholder="‡¶´‡ßã‡¶® ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞"
                                        class="w-full px-4 py-3 rounded-lg bg-white/10 border border-white/30 placeholder-white/70 text-white focus:outline-none focus:ring-2 focus:ring-white backdrop-blur-sm">
                                    <textarea placeholder="‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡¶æ‡¶∞‡ßç‡¶§‡¶æ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®" rows="5" required
                                        class="w-full px-4 py-3 rounded-lg bg-white/10 border border-white/30 placeholder-white/70 text-white focus:outline-none focus:ring-2 focus:ring-white backdrop-blur-sm resize-none"></textarea>
                                    <button type="submit"
                                        class="w-full bg-white text-green-800 px-6 py-4 rounded-lg font-semibold hover:bg-green-50 transition shadow-lg hover:shadow-xl transform hover:scale-105">
                                        ‡¶¨‡¶æ‡¶∞‡ßç‡¶§‡¶æ ‡¶™‡¶æ‡¶†‡¶æ‡¶®
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Footer -->
                <footer class="bg-gray-900 text-white py-12">
                    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                        <div class="grid md:grid-cols-4 gap-8 mb-8">
                            <div class="md:col-span-2">
                                <h3 class="text-2xl font-bold mb-4">${state.siteData.siteName}</h3>
                                <p class="text-gray-400 mb-2">${state.siteData.siteNameEn}</p>
                                <p class="text-gray-400 leading-relaxed">‡¶Ü‡¶¶‡¶ø‡¶¨‡¶æ‡¶∏‡ßÄ‡¶¶‡ßá‡¶∞ ‡¶Ö‡¶ß‡¶ø‡¶ï‡¶æ‡¶∞ ‡¶∞‡¶ï‡ßç‡¶∑‡¶æ ‡¶è‡¶¨‡¶Ç ‡¶∏‡¶æ‡¶∞‡ßç‡¶¨‡¶ø‡¶ï ‡¶â‡¶®‡ßç‡¶®‡¶Ø‡¶º‡¶®‡ßá ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶∂‡ßç‡¶∞‡ßÅ‡¶§‡¶ø‡¶¨‡¶¶‡ßç‡¶ß</p>
                            </div>
                            
                            <div>
                                <h4 class="font-bold mb-4 text-lg">‡¶¶‡ßç‡¶∞‡ßÅ‡¶§ ‡¶≤‡¶ø‡¶Ç‡¶ï</h4>
                                <ul class="space-y-2">
                                    <li><button onclick="scrollToSection('about')" class="text-gray-400 hover:text-white transition">‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶ï‡¶æ‡¶∞‡¶æ</button></li>
                                    <li><button onclick="scrollToSection('mission')" class="text-gray-400 hover:text-white transition">‡¶≤‡¶ï‡ßç‡¶∑‡ßç‡¶Ø</button></li>
                                    <li><button onclick="scrollToSection('objectives')" class="text-gray-400 hover:text-white transition">‡¶â‡¶¶‡ßç‡¶¶‡ßá‡¶∂‡ßç‡¶Ø</button></li>
                                    <li><button onclick="scrollToSection('news')" class="text-gray-400 hover:text-white transition">‡¶∏‡¶Ç‡¶¨‡¶æ‡¶¶</button></li>
                                    <li><button onclick="scrollToSection('gallery')" class="text-gray-400 hover:text-white transition">‡¶ó‡ßç‡¶Ø‡¶æ‡¶≤‡¶æ‡¶∞‡¶ø</button></li>
                                    <li><button onclick="scrollToSection('contact')" class="text-gray-400 hover:text-white transition">‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó</button></li>
                                </ul>
                            </div>
                            
                            <div>
                                <h4 class="font-bold mb-4 text-lg">‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó</h4>
                                <ul class="space-y-2 text-gray-400 text-sm">
                                    <li class="flex items-start">
                                        <i class="fas fa-map-marker-alt mr-2 mt-1"></i>
                                        <span>${state.siteData.contact.address}</span>
                                    </li>
                                    <li class="flex items-center">
                                        <i class="fas fa-phone mr-2"></i>
                                        <span>${state.siteData.contact.phone}</span>
                                    </li>
                                    <li class="flex items-center">
                                        <i class="fas fa-envelope mr-2"></i>
                                        <span>${state.siteData.contact.email}</span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        
                        <div class="border-t border-gray-800 pt-8 flex flex-col md:flex-row justify-between items-center">
                            <p class="text-gray-400 text-sm mb-4 md:mb-0">
                                ¬© ${new Date().getFullYear()} ${state.siteData.siteName}. ‡¶∏‡¶∞‡ßç‡¶¨‡¶∏‡ßç‡¶¨‡¶§‡ßç‡¶¨ ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶ø‡¶§
                            </p>
                            <div class="flex space-x-4">
                                <a href="${state.siteData.contact.facebook}" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-white transition">
                                    <i class="fab fa-facebook-f text-lg"></i>
                                </a>
                                <a href="${state.siteData.contact.twitter}" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-white transition">
                                    <i class="fab fa-twitter text-lg"></i>
                                </a>
                                <a href="${state.siteData.contact.instagram}" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-white transition">
                                    <i class="fab fa-instagram text-lg"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </footer>

                <!-- Scroll to Top Button -->
                <button onclick="window.scrollTo({ top: 0, behavior: 'smooth' });" 
                    id="scrollTopBtn" style="display: none;"
                    class="fixed bottom-8 right-8 bg-green-600 text-white w-14 h-14 rounded-full shadow-2xl hover:bg-green-700 transition z-40 flex items-center justify-center transform hover:scale-110">
                    <i class="fas fa-arrow-up text-xl"></i>
                </button>
            `;
        }
        
        // Auto-slider for public page
        setInterval(() => {
            if (state.view === 'public' && state.siteData && state.siteData.slides && state.siteData.slides.length > 0) {
                state.currentSlide = (state.currentSlide + 1) % state.siteData.slides.length;
                render();
            }
        }, 5000);

        // Initial render (will show loader)
        render();

        // Start Firebase
        initializeFirebase();
    </script>
</body>
</html>
